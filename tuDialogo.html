<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Diálogo de Office</title>
</head>
<body>
  <h1>¡Este es el diálogo!</h1>
  <p id="mensaje">La ventana se abrió correctamente.</p>

  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <script>
   Office.onReady(() => {
  console.log("Office.js está listo en el diálogo.");

  if (Office.context.ui) {
    console.log("Office.context.ui está disponible.");

    // Agregar el handler para recibir mensajes
    Office.context.ui.addHandlerAsync(
      Office.EventType.DialogMessageReceived,
      (arg) => {
        console.log("Mensaje recibido:", arg.message);
        const mensajeElement = document.getElementById("mensaje");
        if (mensajeElement) {
          mensajeElement.innerText = `Mensaje recibido: ${arg.message}`;
        } else {
          console.error("Elemento con id='mensaje' no encontrado.");
        }
      }
    );
  } else {
    console.error("Office.context.ui no está disponible.");
  }
});

  </script>
  
</body>
</html>
