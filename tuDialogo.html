<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Diálogo de Office</title>
</head>
<body>
  <h1>¡Este es el diálogo nuevo!</h1>
  <p id="mensaje">La ventana se abrió correctamente.</p>

  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <script>
Office.onReady(() => {
  console.log("Office.js está listo en el diálogo.");

  // Envía un mensaje al host cuando Office.js está listo
  if (Office.context.ui) {
    console.log("Office.context.ui está disponible.");
    Office.context.ui.messageParent("¡El cuadro de diálogo está listo!");

    // Escucha mensajes del host
    Office.context.ui.addHandlerAsync(
      Office.EventType.DialogParentMessageReceived,
      (arg) => {
        console.log("Mensaje recibido del host:", arg.message);

        const mensajeElement = document.getElementById("mensaje");
        if (mensajeElement) {
          mensajeElement.innerText = `Mensaje recibido del host: ${arg.message}`;
        }
      }
    );
  }
});


  </script>
  
</body>
</html>
