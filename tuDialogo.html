<!DOCTYPE html>
<html>
<head>
  <title>Diálogo</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
  <h1>Datos Recibidos</h1>
  <div id="data-container"></div>
  <button id="close-dialog">Cerrar</button>

  <script>
    Office.onReady(() => {
      console.log("Office.js está listo en el diálogo.");

      // Escuchar mensajes desde el host
      Office.context.ui.addHandlerAsync(
        Office.EventType.DialogMessageReceived,
        (arg) => {
          try {
            const data = JSON.parse(arg.message); // Convertir el mensaje en un objeto
            console.log("Datos recibidos desde el host:", data);

            // Mostrar los datos en el diálogo
            document.getElementById("data-container").innerText = JSON.stringify(data, null, 2);
          } catch (err) {
            console.error("Error al procesar mensaje recibido:", err);
          }
        }
      );

      // Botón para cerrar el diálogo
      document.getElementById("close-dialog").addEventListener("click", () => {
        Office.context.ui.messageParent("cerrar"); // Enviar un mensaje de cierre al host
      });
    });
  </script>
</body>
</html>
