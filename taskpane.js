/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"a35716ea5dbb2eb51cdc.css"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.m=e,n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=o[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function n(){n=function(){return o};var t,o={},r=Object.prototype,a=r.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",l=c.asyncIterator||"@@asyncIterator",u=c.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(t){d=function(e,t,n){return e[t]=n}}function m(e,t,n,o){var r=t&&t.prototype instanceof E?t:E,a=Object.create(r.prototype),c=new N(o||[]);return i(a,"_invoke",{value:L(e,n,c)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}o.wrap=m;var p="suspendedStart",g="suspendedYield",y="executing",v="completed",h={};function E(){}function b(){}function x(){}var I={};d(I,s,(function(){return this}));var T=Object.getPrototypeOf,w=T&&T(T(_([])));w&&w!==r&&a.call(w,s)&&(I=w);var B=x.prototype=E.prototype=Object.create(I);function S(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function k(t,n){function o(r,i,c,s){var l=f(t[r],t,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==e(d)&&a.call(d,"__await")?n.resolve(d.__await).then((function(e){o("next",e,c,s)}),(function(e){o("throw",e,c,s)})):n.resolve(d).then((function(e){u.value=e,c(u)}),(function(e){return o("throw",e,c,s)}))}s(l.arg)}var r;i(this,"_invoke",{value:function(e,t){function a(){return new n((function(n,r){o(e,t,n,r)}))}return r=r?r.then(a,a):a()}})}function L(e,n,o){var r=p;return function(a,i){if(r===y)throw Error("Generator is already running");if(r===v){if("throw"===a)throw i;return{value:t,done:!0}}for(o.method=a,o.arg=i;;){var c=o.delegate;if(c){var s=O(c,o);if(s){if(s===h)continue;return s}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(r===p)throw r=v,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);r=y;var l=f(e,n,o);if("normal"===l.type){if(r=o.done?v:g,l.arg===h)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(r=v,o.method="throw",o.arg=l.arg)}}}function O(e,n){var o=n.method,r=e.iterator[o];if(r===t)return n.delegate=null,"throw"===o&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),h;var a=f(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,h;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function _(n){if(n||""===n){var o=n[s];if(o)return o.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,i=function e(){for(;++r<n.length;)if(a.call(n,r))return e.value=n[r],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(e(n)+" is not iterable")}return b.prototype=x,i(B,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:b,configurable:!0}),b.displayName=d(x,u,"GeneratorFunction"),o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,d(e,u,"GeneratorFunction")),e.prototype=Object.create(B),e},o.awrap=function(e){return{__await:e}},S(k.prototype),d(k.prototype,l,(function(){return this})),o.AsyncIterator=k,o.async=function(e,t,n,r,a){void 0===a&&(a=Promise);var i=new k(m(e,t,n,r),a);return o.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(B),d(B,u,"Generator"),d(B,s,(function(){return this})),d(B,"toString",(function(){return"[object Generator]"})),o.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},o.values=_,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(o,r){return c.type="throw",c.arg=e,n.next=o,r&&(n.method="next",n.arg=t),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=a.call(i,"catchLoc"),l=a.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&a.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var r=o.arg;C(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,o){return this.delegate={iterator:_(e),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=t),h}},o}function o(e,t,n,o,r,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function c(e){o(i,r,a,c,s,"next",e)}function s(e){o(i,r,a,c,s,"throw",e)}c(void 0)}))}}function a(){return a=r(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Word.run(function(){var e=r(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.getItem("authTokenMia")?(I(),i()):(A(),document.getElementById("auth-token").style.display="block",document.getElementById("bg-color").style.display="flex"),e.next=4,t.sync();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),a.apply(this,arguments)}function i(){var e=L();$.ajax({url:"https://miadev.miaintelligence.com:444/api/getDoclangDoccountryFromDocument",type:"POST",contentType:"application/json",headers:{Authorization:"Bearer ".concat(e)},data:JSON.stringify({documentPath:null,documentText:"Doc",onlyCountries:null}),success:function(t){t&&(function(e){if(_(),e)return D(),M(),A(),P(),document.getElementById("classify-document").style.display="block",null!==localStorage.getItem("authTokenMia");M(),A(),console.log("Token is not available.")}(e),m(),console.log("sessionActiveToken: OK"))},error:function(e,t,n){console.log("Error:",n),console.log("Status:",t),console.log("Response Text:",e.responseText),console.log("Ready State:",e.readyState),console.log("HTTP Status Code:",e.status);try{401===e.status&&(console.log("entro sessionActiveToken 401"),N())}catch(e){console.log("Error al parsear JSON de la respuesta:",e)}}})}function c(e){var t=L(),n={doc:e};$.ajax({url:"https://miadev.miaintelligence.com:444/api/classifyGenerative",type:"POST",contentType:"application/json",headers:{Authorization:"Bearer ".concat(t)},data:JSON.stringify(n),success:function(e){console.log("Clasificacion automatica: ",JSON.stringify(e)),function(e){var t=document.getElementById("doctype");e&&e.message?(u(),t.innerText=e.message):e&&e.doctype?(u(),t.innerText=e.doctype,function(e){for(var t=document.getElementById("materia-select"),n=document.getElementById("tipo-doc-select"),o=0;o<t.options.length;o++)if(t.options[o].value===e.subject_code){t.selectedIndex=o;break}var r=document.createEvent("HTMLEvents");r.initEvent("change",!0,!1),t.dispatchEvent(r);for(var a=!1,i=0;i<n.options.length;i++)if(n.options[i].value===e.code){n.selectedIndex=i,a=!0;break}if(!a){var c=document.createElement("option");c.value="sin_clasificar",c.text="sin clasificar",n.appendChild(c),n.selectedIndex=n.options.length-1}v()}(e)):(u(),t.innerText="No response from server.")}(e.data)},error:function(e,t,n){var o;J(),E(),console.log("Estado del error: ",t),console.log("Estado del error: ",n),401===e.status?(o=e.responseJSON.message,N()):o="Error del servidor.",B({message:o})},complete:function(){}})}function s(){Word.run(function(){var e=r(n().mark((function e(t){var o,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(),l(),o=t.document,(r=o.body).load("text"),e.next=7,t.sync();case 7:c(r.text.trim()||"doc vacio");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function l(){var e=document.getElementById("spin"),t=document.getElementById("sping-refresh");e&&e.classList.add("icon-refresh-2","w-600","spin-animation"),t&&t.classList.add("spin-animation")}function u(){var e=document.getElementById("spin"),t=document.getElementById("sping-refresh");e&&e.classList.remove("icon-refresh-2","w-600","spin-animation"),t&&t.classList.remove("spin-animation")}function d(){var e=document.getElementById("doctype");e&&(e.innerText="")}function m(){var e=L();$.ajax({url:"https://miadev.miaintelligence.com:444/api/getGenerativeClassifierConfig",type:"POST",contentType:"application/json",headers:{Authorization:"Bearer ".concat(e)},data:JSON.stringify({lang:"es"}),success:function(e){e&&e.data&&(function(e){!function(e){var n,o,r=document.getElementById("materia-select");r.innerHTML="";for(var a=0,i=Object.entries(e);a<i.length;a++){var c=(n=i[a],o=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,c=[],s=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=a.call(n)).done)&&(c.push(o.value),c.length!==t);s=!0);}catch(e){l=!0,r=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw r}}return c}}(n,o)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?t(e,n):void 0}}(n,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=c[0],l=c[1],u=document.createElement("option");u.value=l,u.textContent=s,r.appendChild(u)}}(e.subject_codes);var n=document.getElementById("materia-select").value;n&&f(e.default_config[n]);var o={penal:"penal",privacidad:"PRIVACIDAD",sin_clasificar:"sin clasificar prueba"};document.getElementById("materia-select").addEventListener("change",(function(){var t=this.value,n=o[t];n?e.default_config[n]?f(e.default_config[n]):console.log("La clave no existe en el JSON:",n):console.log("No se encontró mapeo para el valor seleccionado:",t)}))}(e.data),s(),setTimeout((function(){v()}),6e3))},error:function(e,t,n){console.log("Error:",n),console.log("Status:",t),console.log("Response Text:",e.responseText),console.log("Ready State:",e.readyState),console.log("HTTP Status Code:",e.status);try{401===e.status&&(N(),console.log("entro unauthorizedToken"))}catch(e){console.log("Error al parsear JSON de la respuesta:",e)}}})}function f(e){var t=document.getElementById("tipo-doc-select"),n=document.getElementById("doctype");t.innerHTML="",e&&e.forEach((function(e){var n=document.createElement("option");n.value=e.code,n.textContent=e.doctype,n.dataset.doctype=e.doctype,t.appendChild(n)})),t.addEventListener("change",(function(){var e=t.options[t.selectedIndex];n.textContent=e.dataset.doctype||""})),t.options.length>0&&setTimeout((function(){n.textContent=t.options[t.selectedIndex].dataset.doctype}),2e3)}function p(){var e=document.querySelector(".icon-chevron-right"),t=document.getElementById("classify-document-body");e.classList.toggle("rotated"),"350px"===t.style.height?t.style.height="0":t.style.height="350px"}function g(){var e=document.getElementById("chat-input"),t=e.value.trim();if(t){var n=document.getElementById("chat-box"),o=document.createElement("div");o.classList.add("message","user-message"),o.textContent=t,n.appendChild(o),e.value="",x(),v().then((function(e){y(t,e)}))}}function y(e,t){console.log("texto que le llega a sendTextToServer: "+e),new Promise((function(e,t){Word.run(function(){var o=r(n().mark((function o(r){var a;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,(a=r.document.body).load("text"),n.next=5,r.sync();case 5:e(a.text),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),t("Error al obtener el texto del documento: "+n.t0);case 11:case"end":return n.stop()}}),o,null,[[0,8]])})));return function(e){return o.apply(this,arguments)}}())})).then((function(n){var o,r,a=L();document.getElementById("response-text").innerText="",document.getElementById("loadingMessageEnv").style.display="block",o=document.getElementById("chat-box"),(r=document.createElement("div")).classList.add("message","bot-message","typing-indicator"),r.innerHTML='\n    <div class="typing typing-1"></div>\n    <div class="typing typing-2"></div>\n    <div class="typing typing-3"></div>\n  ',o.appendChild(r),x();var i=localStorage.getItem("conversation_id")||null,c={question:e,conversation_id:i,actions:!1,lang:"es",data:null,raw_text:n,meta:{doclang:"es",generativeClassification:{doctype:t.generativeClassification.doctype,subject_code:t.generativeClassification.subject_code,code:t.generativeClassification.code,subject:t.generativeClassification.subject},doccountry:"España",kind:"conversation",path:""},country:"España",expertMode:!1};console.log("Payload enviado:",JSON.stringify(c)),$.ajax({url:"https://miadev.miaintelligence.com:444/api/callDocChat",type:"POST",contentType:"application/json",headers:{Authorization:"Bearer ".concat(a)},data:JSON.stringify(c),success:function(e){J(),E(),console.log("Payload recibido:",JSON.stringify(e)),h(e)},error:function(e,t,n){var o;J(),E(),console.log("Estado del error: ",t),console.log("Estado del error: ",n),401===e.status?(h(JSON.stringify({data:{messages:[{role:"assistant",content:"La sesión ha caducado."}],conversation_id:"session_expired"}})),setTimeout((function(){N()}),3e3)):o="Error del servidor.",B({message:o})},complete:function(){J()}})})).catch((function(e){console.error(e),B({message:e})}))}function v(){return new Promise((function(e){var t=document.getElementById("materia-select"),n=document.getElementById("tipo-doc-select"),o=document.getElementById("doctype"),r=t.value,a=r,i=n.value;a&&("privacidad"===a&&(a="PRIVACIDAD"),"sin_clasificar"===a&&(a="sin clasificar prueba"));var c={generativeClassification:{doctype:o.textContent,subject_code:r,code:i,subject:a}};console.log(JSON.stringify(c)),console.log("materia: "+r+" Tipo Doc.: "+i+" span: "+o.textContent),e(c)}))}function h(e){var t=document.getElementById("chat-box");if(E(),"string"==typeof e)try{e=JSON.parse(e)}catch(e){return void b("Respuesta del servidor no es un JSON válido.")}if(e&&e.data&&e.data.messages){e.data.conversation_id&&localStorage.setItem("conversation_id",e.data.conversation_id);var n=e.data.messages.reverse().find((function(e){return"assistant"===e.role}));if(n&&n.content){var o=document.createElement("div");o.classList.add("message","bot-message"),o.textContent=n.content,t.appendChild(o),x()}else b("No hay contenido en el mensaje del asistente.")}else b("No response from server.")}function E(){var e=document.querySelector(".typing-indicator");e&&e.remove()}function b(e){var t=document.getElementById("chat-box"),n=document.createElement("div");n.classList.add("message","bot-message"),n.textContent=e,t.appendChild(n),x()}function x(){var e=document.getElementById("chat-box");e.scrollTop=e.scrollHeight}function I(){var e=document.getElementById("chat-box");localStorage.removeItem("conversation_id"),e.innerHTML=""}function T(){Word.run(function(){var e=r(n().mark((function e(t){var o,r,a,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.document,(r=o.getSelection()).load("text"),(a=t.document.body).load("text"),e.next=7,t.sync();case 7:0===(i=r.text.trim()).length&&(i=a.text.trim()),0===i.length?B({message:"El documento está vacío o no hay selección."}):y(i);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function w(e,t){document.getElementById("loadingRevisa").style.display="block",$.ajax({url:"https://servidor-complemento.onrender.com/api/revisa",type:"POST",contentType:"application/json",data:JSON.stringify({authToken:"12345",text:t}),success:function(e){R(),function(e){var t=document.getElementById("response-text-revisa"),n=document.getElementById("group-name"),o=document.getElementById("criteria-select");if(o.innerHTML="",e&&e.reviewedCriteria){var r=new Map,a=document.createDocumentFragment();if(e.reviewedCriteria.forEach((function(o){o.groups.forEach((function(o){t.innerText=e.documentType,n.innerText=o.group,o.criteria.forEach((function(e){r.set(e.title,e);var t=document.createElement("option");t.value=e.title,t.text=e.title,a.appendChild(t)}))}))})),o.appendChild(a),r.size>0){var i=r.values().next().value;o.value=i.title,S(i)}o.addEventListener("change",(function(){var e=this.value,t=r.get(e);t?S(t):console.error("Criterio seleccionado no encontrado.")}))}else t.innerText="No response from server."}(e)},error:function(e,t,n){R();var o="Error del servidor.";console.log("Estado del error: ",t),console.log("Estado del error: ",n),401===e.status&&(o=e.responseJSON.message,N()),B({message:o})},complete:function(){R()}})}function B(e){var t=document.getElementById("response-text");e&&e.message?t.innerText=e.message:t.innerText="No response from server."}function S(e){var t=document.getElementById("criteria-description"),n=document.getElementById("criteria-importance"),o=document.getElementById("criteria-norms"),r=document.getElementById("box-badge");t.innerText=e.description,n.innerText="Importancia: ".concat(e.importance),o.innerText="NORMATIVAS: ".concat(e.associatedNorms.length);var a=e.importance.toLowerCase();n.classList.remove("badge-text-red","badge-text-orange","badge-text-green"),r.classList.remove("badge-bg-red","badge-bg-orange","badge-bg-green"),"alta"===a?(n.classList.add("badge-text-red"),r.classList.add("badge-bg-red")):"media"===a?(n.classList.add("badge-text-orange"),r.classList.add("badge-bg-orange")):"baja"===a&&(n.classList.add("badge-text-green"),r.classList.add("badge-bg-green"))}function k(){var e=document.getElementById("emailUser").value.trim(),t=document.getElementById("passwordUser").value.trim(),n=document.getElementById("error-message-email"),o=document.getElementById("error-message-password");return n.style.display="none",o.style.display="none",0!==e.length&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?0===t.length?(o.innerText="Por favor, ingrese una contraseña.",void(o.style.display="block")):void function(e,t){D(),_(),$.ajax({url:"https://miadev.miaintelligence.com:444/api/auth/logoutFromOtherSessionsAndLogin",type:"POST",contentType:"application/json",data:JSON.stringify({email:e,password:t,remember_me:!1}),success:function(e){if(M(),e.data&&e.data.original&&e.data.original.message){var t=e.data.original.message,n=document.getElementById("error-message-server");n.innerText=t,n.style.display="block"}else{var o,r=null===(o=e.data)||void 0===o?void 0:o.access_token;if(r)localStorage.setItem("authTokenMia",r),I(),function(){M();var e=document.getElementById("response-token");document.getElementById("response-token").style.display="block",e.innerText="Autenticado con éxito",setTimeout((function(){document.getElementById("auth-token").style.display="none",document.getElementById("bg-color").style.display="none",P()}),2e3)}(),m(),setTimeout((function(){document.getElementById("classify-document").style.display="block"}),2100);else{console.error("Token de acceso no encontrado en la respuesta.");var a=document.getElementById("error-message-server");a.innerText="Error: No se pudo obtener el token de acceso.",a.style.display="block"}}},error:function(e){M(),console.log("Estado del xhr ",e);var t=document.getElementById("error-message-server");t.innerText="Error del servidor.",t.style.display="block"},complete:function(){M()}})}(e,t):(n.innerText="El campo email requiere un formato válido (por ejemplo, xxx@xxx.xxx)",void(n.style.display="block"))}function L(){return localStorage.getItem("authTokenMia")}function O(){localStorage.removeItem("authTokenMia"),document.getElementById("response-delete-token").innerText="Token eliminado",setTimeout((function(){window.location.reload()}),2e3)}function j(){localStorage.removeItem("authTokenMia"),setTimeout((function(){window.location.reload()}),2e3)}function C(){Word.run(function(){var e=r(n().mark((function e(t){var o,r,a,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.document,(r=o.getSelection()).load("text"),(a=t.document.body).load("text"),e.next=7,t.sync();case 7:localStorage.getItem("authTokenMia"),0===(i=r.text.trim()).length&&(i=a.text.trim()),0===i.length?G({message:"El documento está vacío.<br> o no hay selección."}):(H(),w(0,i));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function N(){document.getElementById("popup").style.display="flex"}function _(){document.getElementById("loadingMessage").style.display="block"}function P(){document.getElementById("tabs").style.display="block",document.getElementById("tabs-stage").style.display="block"}function A(){document.getElementById("loading-index").style.display="none"}function M(){document.getElementById("loadingMessage").style.display="none"}function J(){document.getElementById("loadingMessageEnv").style.display="none"}function R(){document.getElementById("loadingRevisa").style.display="none"}function D(){document.getElementById("response-session").style.display="none"}function H(){document.getElementById("response-text-revisa").innerHTML=""}function G(e){var t=document.getElementById("response-text-revisa");e&&e.message?t.innerHTML=e.message:t.innerText="No response from server."}Office.onReady((function(e){var t,n,o;e.host===Office.HostType.Word&&(o=Office.context.contentLanguage,console.log("Idioma actual del documento: ",o),"es-AR"===o?console.log("El idioma es Español"):"en-US"===o?console.log("El idioma es Inglés"):console.log("Idioma no detectado"),document.getElementById("auth-token").style.display="none",document.getElementById("bg-color").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("tabs").style.display="none",document.getElementById("tabs-stage").style.display="none",document.getElementById("submitLogin").onclick=k,document.getElementById("eliminar-token").onclick=O,document.getElementById("classify-document-container").onclick=p,document.getElementById("close-document-container").onclick=p,document.getElementById("get-classify-auto").onclick=s,document.getElementById("reload-plugin").onclick=j,document.getElementById("clean-document").onclick=I,document.getElementById("revisa-btn").onclick=C,document.getElementById("document-forward").addEventListener("click",T),document.getElementById("send-btn").onclick=g,document.getElementById("chat-input").onkeypress=function(e){"Enter"===e.key&&(e.preventDefault(),g())},t=document.querySelectorAll(".tabs-nav li a"),(n=document.querySelectorAll(".tabs-stage > div")).forEach((function(e){return e.style.display="none"})),n[0].style.display="block",t.forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),document.querySelector(".tabs-nav li.tab-active").classList.remove("tab-active"),this.parentElement.classList.add("tab-active"),n.forEach((function(e){return e.style.display="none"}));var t=this.getAttribute("href");document.querySelector(t).style.display="block"}))}))),function(){a.apply(this,arguments)}()}))}(),new URL(n(58394),n.b)}();
//# sourceMappingURL=taskpane.js.map
