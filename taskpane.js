/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"a1344e858d0278cff85a.css"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.m=e,n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=o[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){if(e){if("string"==typeof e)return n(e,t);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function o(){o=function(){return n};var t,n={},r=Object.prototype,a=r.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",l=c.asyncIterator||"@@asyncIterator",d=c.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(t){u=function(e,t,n){return e[t]=n}}function p(e,t,n,o){var r=t&&t.prototype instanceof b?t:b,a=Object.create(r.prototype),c=new C(o||[]);return i(a,"_invoke",{value:L(e,n,c)}),a}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=p;var f="suspendedStart",g="suspendedYield",y="executing",v="completed",h={};function b(){}function E(){}function x(){}var w={};u(w,s,(function(){return this}));var I=Object.getPrototypeOf,T=I&&I(I(N([])));T&&T!==r&&a.call(T,s)&&(w=T);var B=x.prototype=b.prototype=Object.create(w);function k(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(t,n){function o(r,i,c,s){var l=m(t[r],t,i);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==e(u)&&a.call(u,"__await")?n.resolve(u.__await).then((function(e){o("next",e,c,s)}),(function(e){o("throw",e,c,s)})):n.resolve(u).then((function(e){d.value=e,c(d)}),(function(e){return o("throw",e,c,s)}))}s(l.arg)}var r;i(this,"_invoke",{value:function(e,t){function a(){return new n((function(n,r){o(e,t,n,r)}))}return r=r?r.then(a,a):a()}})}function L(e,n,o){var r=f;return function(a,i){if(r===y)throw Error("Generator is already running");if(r===v){if("throw"===a)throw i;return{value:t,done:!0}}for(o.method=a,o.arg=i;;){var c=o.delegate;if(c){var s=O(c,o);if(s){if(s===h)continue;return s}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(r===f)throw r=v,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);r=y;var l=m(e,n,o);if("normal"===l.type){if(r=o.done?v:g,l.arg===h)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(r=v,o.method="throw",o.arg=l.arg)}}}function O(e,n){var o=n.method,r=e.iterator[o];if(r===t)return n.delegate=null,"throw"===o&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),h;var a=m(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,h;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function N(n){if(n||""===n){var o=n[s];if(o)return o.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,i=function e(){for(;++r<n.length;)if(a.call(n,r))return e.value=n[r],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(e(n)+" is not iterable")}return E.prototype=x,i(B,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:E,configurable:!0}),E.displayName=u(x,d,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===E||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,u(e,d,"GeneratorFunction")),e.prototype=Object.create(B),e},n.awrap=function(e){return{__await:e}},k(S.prototype),u(S.prototype,l,(function(){return this})),n.AsyncIterator=S,n.async=function(e,t,o,r,a){void 0===a&&(a=Promise);var i=new S(p(e,t,o,r),a);return n.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(B),u(B,d,"Generator"),u(B,s,(function(){return this})),u(B,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},n.values=N,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(o,r){return c.type="throw",c.arg=e,n.next=o,r&&(n.method="next",n.arg=t),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=a.call(i,"catchLoc"),l=a.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&a.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var r=o.arg;_(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,o){return this.delegate={iterator:N(e),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=t),h}},n}function r(e,t,n,o,r,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var i=e.apply(t,n);function c(e){r(i,o,a,c,s,"next",e)}function s(e){r(i,o,a,c,s,"throw",e)}c(void 0)}))}}function i(){return i=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Word.run(function(){var e=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("authTokenMia"),$(document).on("click",".switch-container",(function(e){e.stopPropagation()})),$(document).on("click",".icon-refresh-revisa",(function(e){e.stopPropagation()})),$(document).on("click",".collapser",(function(e){var t=$(this),n=t.closest(".collapse"),o=t.closest(".menu-group");n.length>0?n.find(".collapser").not(t).removeClass("open").addClass("collapsed").next(".collapse").collapse("hide"):(o.find(".collapser").not(t).removeClass("open").addClass("collapsed").next(".collapse").collapse("hide"),console.log("entro en el else")),t.toggleClass("collapsed open"),t.next(".collapse").collapse("toggle"),e.stopPropagation()})),n?(B(),l()):(J(),document.getElementById("auth-token").style.display="block",document.getElementById("bg-color").style.display="flex"),e.next=5,t.sync();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)}function c(){var e=window.screen.width/2-300,t=window.screen.height/2-250,n=window.open("https://victorwake.github.io/MiaWord/postMessage.html","PopupWindow","width=".concat(600,",height=").concat(500,",left=").concat(e,",top=").concat(t,",toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no"));window.addEventListener("message",(function(e){"ready"===e.data&&n.postMessage("Este es un mensaje enviado desde el complemento.","*")}))}function s(){Office.context.ui.displayDialogAsync("https://victorwake.github.io/MiaWord/tuDialogo.html",{height:50,width:50,displayInIframe:!0},(function(e){if(e.status===Office.AsyncResultStatus.Failed)console.error("Error al abrir el diálogo:",e.error.message);else{var t=e.value;console.log("Diálogo abierto exitosamente."),t.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){console.log("Mensaje recibido del diálogo:",e.message),t.close()}));var n="Este es un mensaje enviado desde el complemento.";setTimeout((function(){t?(t.messageChild(n),console.log("Mensaje enviado al diálogo:",n)):console.error("Error: El diálogo no se ha abierto correctamente.")}),2e3)}}))}function l(){var e=C();$.ajax({url:"https://miadev.miaintelligence.com:444/api/getDoclangDoccountryFromDocument",type:"POST",contentType:"application/json",headers:{Authorization:"Bearer ".concat(e)},data:JSON.stringify({documentPath:null,documentText:"Doc",onlyCountries:null}),success:function(t){t&&(function(e){if(P(),e)return R(),q(),J(),D(),document.getElementById("classify-document").style.display="block",null!==localStorage.getItem("authTokenMia");q(),J(),console.log("Token is not available.")}(e),g(),console.log("sessionActiveToken: OK"))},error:function(e,t,n){console.log("Error:",n),console.log("Status:",t),console.log("Response Text:",e.responseText),console.log("Ready State:",e.readyState),console.log("HTTP Status Code:",e.status);try{401===e.status&&(console.log("entro sessionActiveToken 401"),M())}catch(e){console.log("Error al parsear JSON de la respuesta:",e)}}})}function d(e){var t=C(),n={doc:e};$.ajax({url:"https://miadev.miaintelligence.com:444/api/classifyGenerative",type:"POST",contentType:"application/json",headers:{Authorization:"Bearer ".concat(t)},data:JSON.stringify(n),success:function(e){console.log("Clasificacion automatica: ",JSON.stringify(e)),function(e){var t=document.getElementById("doctype");e&&e.message?(m(),t.innerText=e.message):e&&e.doctype?(m(),t.innerText=e.doctype,function(e){for(var t=document.getElementById("materia-select"),n=document.getElementById("tipo-doc-select"),o=0;o<t.options.length;o++)if(t.options[o].value===e.subject_code){t.selectedIndex=o;break}var r=document.createEvent("HTMLEvents");r.initEvent("change",!0,!1),t.dispatchEvent(r);for(var a=!1,i=0;i<n.options.length;i++)if(n.options[i].value===e.code){n.selectedIndex=i,a=!0;break}if(!a){var c=document.createElement("option");c.value="sin_clasificar",c.text="sin clasificar",n.appendChild(c),n.selectedIndex=n.options.length-1}E()}(e)):(m(),t.innerText="No response from server.")}(e.data)},error:function(e,t,n){var o;H(),w(),console.log("Estado del error: ",t),console.log("Estado del error: ",n),401===e.status?(o=e.responseJSON.message,M()):o="Error del servidor.",_({message:o})},complete:function(){}})}function u(){Word.run(function(){var e=a(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(),p(),n=t.document,(r=n.body).load("text"),e.next=7,t.sync();case 7:d(r.text.trim()||"doc vacio");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function p(){var e=document.getElementById("spin"),t=document.getElementById("sping-refresh");e&&e.classList.add("icon-refresh-2","w-600","spin-animation"),t&&t.classList.add("spin-animation")}function m(){var e=document.getElementById("spin"),t=document.getElementById("sping-refresh");e&&e.classList.remove("icon-refresh-2","w-600","spin-animation"),t&&t.classList.remove("spin-animation")}function f(){var e=document.getElementById("doctype");e&&(e.innerText="")}function g(){var e=C();$.ajax({url:"https://miadev.miaintelligence.com:444/api/getGenerativeClassifierConfig",type:"POST",contentType:"application/json",headers:{Authorization:"Bearer ".concat(e)},data:JSON.stringify({lang:"es"}),success:function(e){e&&e.data&&(function(e){!function(e){var n,o,r=document.getElementById("materia-select");r.innerHTML="";for(var a=0,i=Object.entries(e);a<i.length;a++){var c=(n=i[a],o=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,c=[],s=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=a.call(n)).done)&&(c.push(o.value),c.length!==t);s=!0);}catch(e){l=!0,r=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw r}}return c}}(n,o)||t(n,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=c[0],l=c[1],d=document.createElement("option");d.value=l,d.textContent=s,r.appendChild(d)}}(e.subject_codes);var n=document.getElementById("materia-select").value;n&&y(e.default_config[n]);var o={penal:"penal",privacidad:"PRIVACIDAD",sin_clasificar:"sin clasificar prueba"};document.getElementById("materia-select").addEventListener("change",(function(){var t=this.value,n=o[t];n?e.default_config[n]?y(e.default_config[n]):console.log("La clave no existe en el JSON:",n):console.log("No se encontró mapeo para el valor seleccionado:",t)}))}(e.data),u(),setTimeout((function(){E()}),6e3))},error:function(e,t,n){console.log("Error:",n),console.log("Status:",t),console.log("Response Text:",e.responseText),console.log("Ready State:",e.readyState),console.log("HTTP Status Code:",e.status);try{401===e.status&&(M(),console.log("entro unauthorizedToken"))}catch(e){console.log("Error al parsear JSON de la respuesta:",e)}}})}function y(e){var t=document.getElementById("tipo-doc-select"),n=document.getElementById("doctype");t.innerHTML="",e&&e.forEach((function(e){var n=document.createElement("option");n.value=e.code,n.textContent=e.doctype,n.dataset.doctype=e.doctype,t.appendChild(n)})),t.addEventListener("change",(function(){var e=t.options[t.selectedIndex];n.textContent=e.dataset.doctype||""})),t.options.length>0&&setTimeout((function(){n.textContent=t.options[t.selectedIndex].dataset.doctype}),2e3)}function v(){var e=document.querySelector(".icon-chevron-right"),t=document.getElementById("classify-document-body");e.classList.toggle("rotated"),"350px"===t.style.height?t.style.height="0":t.style.height="350px"}function h(){var e=document.getElementById("chat-input"),t=e.value.trim();if(t){var n=document.getElementById("chat-box"),o=document.createElement("div");o.classList.add("message","user-message"),o.textContent=t,n.appendChild(o),e.value="",T(),E().then((function(e){b(t,e)}))}}function b(e,t){console.log("texto que le llega a sendTextToServer: "+e),new Promise((function(e,t){Word.run(function(){var n=a(o().mark((function n(r){var a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,(a=r.document.body).load("text"),n.next=5,r.sync();case 5:e(a.text),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),t("Error al obtener el texto del documento: "+n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}())})).then((function(n){var o,r,a=C();document.getElementById("response-text").innerText="",document.getElementById("loadingMessageEnv").style.display="block",o=document.getElementById("chat-box"),(r=document.createElement("div")).classList.add("message","bot-message","typing-indicator"),r.innerHTML='\n    <div class="typing typing-1"></div>\n    <div class="typing typing-2"></div>\n    <div class="typing typing-3"></div>\n  ',o.appendChild(r),T();var i=localStorage.getItem("conversation_id")||null,c={question:e,conversation_id:i,actions:!1,lang:"es",data:null,raw_text:n,meta:{doclang:"es",generativeClassification:{doctype:t.generativeClassification.doctype,subject_code:t.generativeClassification.subject_code,code:t.generativeClassification.code,subject:t.generativeClassification.subject},doccountry:"España"},country:"España",expertMode:!1};console.log("Payload enviado:",JSON.stringify(c)),$.ajax({url:"https://miadev.miaintelligence.com:444/api/callDocChat",type:"POST",contentType:"application/json",headers:{Authorization:"Bearer ".concat(a)},data:JSON.stringify(c),success:function(e){H(),w(),console.log("Payload recibido:",JSON.stringify(e)),x(e)},error:function(e,t,n){var o;H(),w(),console.log("Estado del error: ",t),console.log("Estado del error: ",n),401===e.status?(x(JSON.stringify({data:{messages:[{role:"assistant",content:"La sesión ha caducado."}],conversation_id:"session_expired"}})),setTimeout((function(){M()}),3e3)):o="Error del servidor.",_({message:o})},complete:function(){H()}})})).catch((function(e){console.error(e),_({message:e})}))}function E(){return new Promise((function(e){var t=document.getElementById("materia-select"),n=document.getElementById("tipo-doc-select"),o=document.getElementById("doctype"),r=t.value,a=r,i=n.value;a&&("privacidad"===a&&(a="PRIVACIDAD"),"sin_clasificar"===a&&(a="sin clasificar prueba"));var c={generativeClassification:{doctype:o.textContent,subject_code:r,code:i,subject:a}};console.log(JSON.stringify(c)),console.log("materia: "+r+" Tipo Doc.: "+i+" span: "+o.textContent),e(c)}))}function x(e){var t=document.getElementById("chat-box");if(w(),"string"==typeof e)try{e=JSON.parse(e)}catch(e){return void I("Respuesta del servidor no es un JSON válido.")}if(e&&e.data&&e.data.messages){e.data.conversation_id&&localStorage.setItem("conversation_id",e.data.conversation_id);var n=e.data.messages.reverse().find((function(e){return"assistant"===e.role}));if(n&&n.content){var o=document.createElement("div");o.classList.add("message","bot-message"),o.textContent=n.content,t.appendChild(o),T()}else I("No hay contenido en el mensaje del asistente.")}else I("No response from server.")}function w(){var e=document.querySelector(".typing-indicator");e&&e.remove()}function I(e){var t=document.getElementById("chat-box"),n=document.createElement("div");n.classList.add("message","bot-message"),n.textContent=e,t.appendChild(n),T()}function T(){var e=document.getElementById("chat-box");e.scrollTop=e.scrollHeight}function B(){var e=document.getElementById("chat-box");localStorage.removeItem("conversation_id"),e.innerHTML=""}function k(){Word.run(function(){var e=a(o().mark((function e(t){var n,r,a,i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.document,(r=n.getSelection()).load("text"),(a=t.document.body).load("text"),e.next=7,t.sync();case 7:if(i=r.text.trim(),c=!1,0===i.length&&(i=a.text.trim(),c=!0),0!==i.length){e.next=13;break}return _({message:"El documento está vacío o no hay selección."}),e.abrupt("return");case 13:E().then((function(e){e&&e.generativeClassification?S(i,e,c):_({message:"No se encontraron datos adicionales para enviar junto con el texto."})})).catch((function(e){console.error("Error al obtener docData:",e),_({message:"Error al procesar los datos del documento."})}));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function S(e,t,n){var o=document.getElementById("chat-box"),r=document.createElement("div");r.classList.add("message","user-message"),r.textContent=n?"Doc.":e,o.appendChild(r),T(),b(e,t)}function L(){var e,t;e=document.getElementById("qualifier-groups"),t=document.getElementById("qualifier_custom_groups"),e&&(e.innerHTML=""),t&&(t.innerHTML=""),O("add");var n=C(),o=document.getElementById("tipo-doc-select").value;console.log("Texto del select: "+o);var r={doctype_code:o,country:"España",lang:"es"};console.log("Payload enviado:",JSON.stringify(r)),$.ajax({url:"https://miadev.miaintelligence.com:444/api/getMatchGroups",type:"POST",contentType:"application/json",headers:{Authorization:"Bearer ".concat(n)},data:JSON.stringify(r),success:function(e){console.log("Match Groups: ",JSON.stringify(e)),function(e){console.log("Datos recibidos:",e),function(){var e=document.getElementById("doctype");if(e){O("remove");var t=e.textContent||e.innerText,n=document.getElementById("criteria-title"),o=document.getElementById("own-criteria-title");n?n.textContent=t:console.warn("El elemento con ID 'criteria-title' no existe."),o?o.textContent=t:console.warn("El elemento con ID 'own-criteria-title' no existe.")}else console.warn("El elemento con ID 'doctype' no existe.")}();var t=document.getElementById("qualifier-groups"),n=document.getElementById("qualifier_custom_groups");n.innerHTML="";var o=function(e,t,n){if(e&&0!==e.length&&!e.every((function(e){return!e.associated_criterias||0===e.associated_criterias.length}))){var o=1;e.forEach((function(e){var r=document.createElement("div");r.className="card";var a='\n       <a class="card-header collapsed collapser">\n         <div class="group2">\n           <div class="left-content">\n             <mat-icon class="mat-icon text-xl text-grey-medium material-icons mat-ligature-font mat-icon-no-color icono-izquierda">filter_list</mat-icon>\n             <span class="text-sm !font-semibold text-left bW w-100">'.concat(e.title,'</span>\n           </div>\n           <div class="right-content">\n             <span class="icon icon-chevron-down"></span>\n             <div class="switch-container">\n               <input type="checkbox" id="switch2" class="switch-checkbox" checked />\n               <label for="switch2" class="switch-label">Toggle 2</label>\n             </div>\n             <div class="icon-refresh-revisa"><span class="icon icon-refresh"></span></div>\n           </div>\n         </div>\n       </a>\n     ');r.innerHTML=a;var i=document.createElement("div");i.className="collapse",e.associated_criterias.forEach((function(e,t){var r,a,c="rec-grey",s="icon-minus";"ko"===e.evaluation?(c="rec-red",s="icon-x"):"ok"===e.evaluation&&(c="rec-green",s="icon-check");var l=function(e,t){return{1:"".concat(t,"-green"),2:"".concat(t,"-yellow"),3:"".concat(t,"-orange"),4:"".concat(t,"-red")}[e]||"".concat(t,"-default")},d=l(e.weight,"round-ico"),u=l(e.weight,"badge-bg"),p=l(e.weight,"badge-text"),m={1:"Bajo",2:"Medio",3:"Alto",4:"Muy Alto"}[e.weight]||"",f=e.exclude?'<div class="badge badge-bg-ligth-blue no-select">\n             <span class="badge-text-ligth-blue">Excluyente: Sí</span>\n           </div>':"",g=e.exclude?'<mat-icon _ngcontent-ng-c279190276="" class="mat-icon exclude-icon material-icons">warning</mat-icon>':"",y="".concat(n,"submenu-").concat(t),v=(null===(r=e.normative_refs)||void 0===r||null===(r=r.es)||void 0===r||null===(r=r.refs)||void 0===r?void 0:r.length)||0,h=((null===(a=e.normative_refs)||void 0===a||null===(a=a.es)||void 0===a?void 0:a.refs)||[]).map((function(e){return'\n             <div class="">\n               <div class="alert-norm alert-icon-flex !mt-4 ng-star-inserted">\n                 <span class="norm-margin">\n                   <p class="font-bold">Normativas</p>\n                   <p class="text-xs">'.concat(e.normative_reference,'</p>\n                 </span>\n               </div>\n               <div class="danger-alert alert-icon-flex !mt-4 ng-star-inserted">\n                 <span class="icon icon-danger danger-alert-icon"></span>\n                 <span class="norm-margin">\n                   <p class="font-bold">Incumplimiento</p>\n                   <p class="text-xs">').concat(e.threat,"</p>\n                 </span>\n               </div>\n             </div>\n           ")})).join(""),b="".concat(n,"normativas-btn-").concat(o),E="".concat(n,"exclude-card-").concat(o),x='\n         <div class="card">\n           <a class="card-header collapser" data-toggle="collapse" data-target="#'.concat(y,'">\n               <div class="grupo3-box pb-3">\n                   <div class="container-grup3 ms-2">\n                       <span class="rec-box ').concat(c,'">\n                           <span class="icon ').concat(s,'"></span>\n                       </span>\n                       <span class="text-left">\n                       ').concat(e.title,'\n                       </span>\n                   </div>\n                   <div class="right-icons">\n                       ').concat(g,'\n                       <div class="round-ico ').concat(d,'"></div>\n                       <span class="icon icon-chevron-down ms-1"></span>\n                   </div>\n               </div>\n           </a>\n           <div id="').concat(y,'" class="collapse">\n             <div class="card-body sub px-3">\n               <span class="span-sub-content">').concat(e.description,'</span>\n               <div class="container-badge">\n                 <div class="badge ').concat(u,' no-select">\n                   <div class="round-ico-badge ').concat(d,'"></div>\n                   <span id="criteria-importance" class="').concat(p,'">Importancia: ').concat(m,'</span>\n                 </div>\n                 <div id="').concat(b,'" class="badge badge-bg-ligth-blue no-select cursor-pointer" onclick="toggleCard(').concat(o,", '").concat(n,'\')">\n                   <span class="badge-text-ligth-blue">NORMATIVAS: ').concat(v,"</span>\n                 </div>\n                 ").concat(f,'\n               </div>\n                <div id="').concat(E,'" class="hidden">\n                 ').concat(h,'\n               </div>\n               <div>\n                   <div class="container-btn">\n                       <span class="btn-revisa btn-green no-select no-close">\n                       <span class="icon icon-refresh icon-white"></span>Revisar</span>\n                       <span class="btn-revisa btn-grey no-select no-close">\n                       <span class="icon icon-task-square icon-white"></span>Corregir</span>\n                   </div>\n               </div>\n             </div>\n           </div>\n         </div>\n       ');i.innerHTML+=x,o++})),r.appendChild(i),t.appendChild(r)}))}else t.innerHTML='<div class="generative-qualifier-container h-full">\n  <div class="accordion">\n    <div style="width: 100%; display: flex; justify-content: center;">\n      <div class="info-alert alert-icon-flex my-1 text-xs py-2 !p-2 mx-4 ng-star-inserted">\n        <span class="icon icon-info-circle1 info-alert-icon"></span>\n        <span class="info-alert-text">\n          No se han configurado grupos de criterios para: Tipo de criterio + Tipo\n          de documento + País.\n        </span>\n      </div>\n    </div>\n  </div>\n</div>\n'};o(e.data.qualifier_groups,t,"group"),o(e.data.qualifier_custom_groups,n,"customGroup")}(e)},error:function(e,t,n){var o;console.log("Estado del error: ",t),console.log("Estado del error: ",n),401===e.status?(o=e.responseJSON.message,M()):o="Error del servidor.",console.log({message:o})},complete:function(){}})}function O(e){[{id:"spin-revisa",classes:["icon-refresh-2","w-600","spin-animation"]},{id:"refresh-spin-revisa",classes:["icon-refresh-2","w-800","spin-animation"]},{id:"refresh-spin-revisa-2",classes:["icon-refresh-2","w-800","spin-animation"]},{id:"spin-revisa-1",classes:["icon-refresh-2","w-600","spin-animation"]},{id:"refresh-groups",classes:["spin-animation"]},{id:"refresh-groups-1",classes:["spin-animation"]},{id:"sping-refresh",classes:["spin-animation"]}].forEach((function(o){var r,a,i=o.id,c=o.classes,s=document.getElementById(i);s&&(r=s.classList)[e].apply(r,function(e){if(Array.isArray(e))return n(e)}(a=c)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||t(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}))}function j(){var e=document.getElementById("emailUser").value.trim(),t=document.getElementById("passwordUser").value.trim(),n=document.getElementById("error-message-email"),o=document.getElementById("error-message-password");return n.style.display="none",o.style.display="none",0!==e.length&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?0===t.length?(o.innerText="Por favor, ingrese una contraseña.",void(o.style.display="block")):void function(e,t){R(),P(),$.ajax({url:"https://miadev.miaintelligence.com:444/api/auth/logoutFromOtherSessionsAndLogin",type:"POST",contentType:"application/json",data:JSON.stringify({email:e,password:t,remember_me:!1}),success:function(e){if(q(),e.data&&e.data.original&&e.data.original.message){var t=e.data.original.message,n=document.getElementById("error-message-server");n.innerText=t,n.style.display="block"}else{var o,r=null===(o=e.data)||void 0===o?void 0:o.access_token;if(r)localStorage.setItem("authTokenMia",r),B(),function(){q();var e=document.getElementById("response-token");document.getElementById("response-token").style.display="block",e.innerText="Autenticado con éxito",setTimeout((function(){document.getElementById("auth-token").style.display="none",document.getElementById("bg-color").style.display="none",D()}),2e3)}(),g(),setTimeout((function(){document.getElementById("classify-document").style.display="block"}),2100);else{console.error("Token de acceso no encontrado en la respuesta.");var a=document.getElementById("error-message-server");a.innerText="Error: No se pudo obtener el token de acceso.",a.style.display="block"}}},error:function(e){q(),console.log("Estado del xhr ",e);var t=document.getElementById("error-message-server");t.innerText="Error del servidor.",t.style.display="block"},complete:function(){q()}})}(e,t):(n.innerText="El campo email requiere un formato válido (por ejemplo, xxx@xxx.xxx)",void(n.style.display="block"))}function _(e){var t=document.getElementById("response-text");e&&e.message?t.innerText=e.message:t.innerText="No response from server."}function C(){return localStorage.getItem("authTokenMia")}function N(){localStorage.removeItem("authTokenMia"),document.getElementById("response-delete-token").innerText="Token eliminado",setTimeout((function(){window.location.reload()}),2e3)}function A(){localStorage.removeItem("authTokenMia"),setTimeout((function(){window.location.reload()}),2e3)}function M(){document.getElementById("popup").style.display="flex"}function P(){document.getElementById("loadingMessage").style.display="block"}function D(){document.getElementById("tabs").style.display="block",document.getElementById("tabs-stage").style.display="block"}function J(){document.getElementById("loading-index").style.display="none"}function q(){document.getElementById("loadingMessage").style.display="none"}function H(){document.getElementById("loadingMessageEnv").style.display="none"}function R(){document.getElementById("response-session").style.display="none"}Office.onReady((function(e){var t,n,o;e.host===Office.HostType.Word&&(o=Office.context.contentLanguage,console.log("Idioma actual del documento: ",o),"es-AR"===o?console.log("El idioma es Español"):"en-US"===o?console.log("El idioma es Inglés"):console.log("Idioma no detectado"),document.getElementById("auth-token").style.display="none",document.getElementById("bg-color").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("tabs").style.display="none",document.getElementById("tabs-stage").style.display="none",document.getElementById("submitLogin").onclick=j,document.getElementById("eliminar-token").onclick=N,document.getElementById("classify-document-container").onclick=v,document.getElementById("close-document-container").onclick=v,document.getElementById("get-classify-auto").onclick=u,document.getElementById("reload-plugin").onclick=A,document.getElementById("openDialogButton").onclick=s,document.getElementById("openDialogButton2").onclick=c,document.getElementById("get-match-groups").onclick=L,document.getElementById("clean-document").onclick=B,document.getElementById("document-forward").addEventListener("click",k),document.getElementById("send-btn").onclick=h,document.getElementById("chat-input").onkeypress=function(e){"Enter"===e.key&&(e.preventDefault(),h())},t=document.querySelectorAll(".tabs-nav li a"),(n=document.querySelectorAll(".tabs-stage > div")).forEach((function(e){return e.style.display="none"})),n[0].style.display="block",t.forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),document.querySelector(".tabs-nav li.tab-active").classList.remove("tab-active"),this.parentElement.classList.add("tab-active"),n.forEach((function(e){return e.style.display="none"}));var t=this.getAttribute("href");document.querySelector(t).style.display="block"}))}))),function(){i.apply(this,arguments)}()}))}(),new URL(n(58394),n.b)}();
//# sourceMappingURL=taskpane.js.map
