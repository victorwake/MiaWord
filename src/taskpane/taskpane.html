<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!-- This file shows how to design a first-run page that provides a welcome screen to the user about the features of the add-in. -->

<!doctype html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MIAbogado</title>

  <!-- Office JavaScript API -->
  <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <script src="config.js"></script>

  <!-- For more information on Fluent UI, visit https://developer.microsoft.com/fluentui#/. -->
  <link rel="stylesheet"
    href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css" />

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" /> -->

  <!-- Template styles -->
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css'>
  <link href="taskpane.css" rel="stylesheet" type="text/css" />
  <style>
    @import "https://s3.eu-west-1.amazonaws.com/cdn.ecixgroup.com/icons/fonts/ecix-icons.css";
  </style>
</head>

<body class="ms-font-m ms-welcome ms-Fabric body">
  <header class="ms-welcome__header">
    <!-- -------------------------Inicio Index Token--------------------------- -->
    <div id="bg-color" class="no-select">
      <img width="90" height="90" src="https://victorwake.github.io/mia/assets/logo-filled.png" alt="Ecix"
        title="Ecix" />
      <div class="logo-box">
        <img width="200" height="30" src="https://miabogado.law/assets/images/MIAbogado.svg" alt="Ecix" title="Ecix" />
      </div>
    </div>
    <!-- -------------------------Fin Index Token--------------------------- -->
    <div id="loading-index" class="loader"></div>
    <!-- -------------------------Inicio pestañas--------------------------- -->
    <section id="classify-document" class="classify-document no-select" style="display: none;">
      <div class="classify-document-box">
        <div id="classify-document-container" class="classify-document-container">
          <span id="doctype"></span>
          <span id="spin" class="icon "></span>
          <span class="icon icon-chevron-right"></span>
        </div>
        <section id="classify-document-body">
          <!-- Cuerpo -->
          <section class="container-shadow">
            <p class="custom-paragraph">
              <span class="left-text">Tipo de documento</span>
              <span id="get-classify-auto" class="right-text c-p"><span id="sping-refresh"
                  class="icon icon-refresh-2 w-600"></span>Clasif.automática</span>
            </p>

            <div class="box-select">
              <label for="materia-select" class="font-select-label">Materia</label>
              <div class="select">
                <select name="" id="materia-select" class="custom-select" title="Materia">
                  <!-- Opciones -->
                </select>
              </div>
              <label for="tipo-doc-select" class="mt-3 font-select-label">Tipo de documento</label>
              <div class="select">
                <select name="" id="tipo-doc-select" class="custom-select" title="Tipo de documento">
                  <!-- Opciones -->
                </select>
              </div>
            </div>
            <div>
              <div class="container-btn">
                <!-- <span id="openDialogButton" class="btn-clasif-auto btn-aplicar btn-green no-select">Aplicar</span> -->
                <span id="close-document-container"
                  class=" btn-clasif-auto btn-aplicar btn-green no-select">Cerrar</span>
              </div>
            </div>
          </section>
        </section>
      </div>
    </section>

    <div id="tabs">
      <ul class="tabs-nav">
        <li class="li-box tab-active">
          <a href="#tab-1"><span class="icon icons-ref icon-message-question"></span>Consulta</a>
        </li>
        <li class="li-box">
          <a href="#tab-2"><span class="icon icons-ref icon-search-status"></span>Revisa</a>
        </li>
        <li class="li-box">
          <a href="#tab-3"><span class="icon icons-ref icon-clipboard-import"></span>Extrae</a>
        </li>
      </ul>
    </div>
    <!-- -------------------------Fin pestañas--------------------------- -->
  </header>

  <main id="app-body" class="ms-welcome__main">
    <!-- -------------------------Inicio Token--------------------------- -->
    <section id="auth-token" class="ms-welcome__main">
      <div id="auth-dialog">
        <div class="box-token">
          <label for="emailUser" class="no-select">Correo electrónico </label>
          <div class="box-input">
            <input type="email" id="emailUser" class="input-login" />
            <div id="error-message-email" style="color: red; display: none"></div>
          </div>
          <label for="passwordUser" class="no-select">Contraseña</label>
          <div class="box-input lol">
            <input type="password" id="passwordUser" class="input-login" />
            <div id="error-message-password" style="color: red; display: none"></div>
          </div>
        </div>
        <button id="submitLogin" class="no-select">Iniciar sesión</button>
        <div id="error-message-server" style="color: red; display: none"></div>
        <div class="box-loading">
          <div id="response-token" style="display: none"></div>
          <div id="response-session" style="display: none"></div>
          <div id="loadingMessage" class="loader" style="display: none"></div>
        </div>
      </div>
    </section>
    <!-- -------------------------Fin Token--------------------------- -->
    <!-- ------------------Inicio Cuerpo de pestañas------------------ -->
    <section id="tabs-stage" class="tabs-stage">
      <!-- ------------------Inicio pestaña Consulta------------------ -->
      <div id="tab-1" style="display: block">
        <div class="chat-container">
          <div class="chat-box" id="chat-box"></div>
          <div id="clean-document" class="container-clean-btn no-select">
            <span class="icon icon-clean clean-document"></span>
            <p class="text-clean">Nueva conversación</p>
          </div>
          <div class="textarea-container">
            <textarea class="form-control" id="chat-input" placeholder="Escribe aquí..."></textarea>
            <span title="Envia seleccion del Doc." id="document-forward"
              class="icon icons-ref icon-document-forward document-forward"></span>
            <span class="separator">|</span>
            <span id="send-btn" class="material-icons send">send</span>
          </div>
        </div>
      </div>
      <!-- ------------------Fin pestaña Consulta------------------ -->
      <!-- ------------------Inicio pestaña Revisa------------------ -->
      <div id="tab-2" style="display: none">
        <div class="revisa-container">

          <div class="container">
            <div class="row">
              <div class="col">
                <div class="accordion">
                  <div class="menu-group">
                    <div class="card">
                      <div class="menu-group"></div>
                      <!-- Menu fijo -->
                      <div class="group no-select">
                        <div>
                          <div class="title">Grupo de Criterios Normativos:</div>
                          <div id="criteria-title" class="subtitle"></div>
                          <span id="spin-revisa" class="icon "></span>
                        </div>
                        <div id="get-match-groups" class="icon-refresh-revisa"><span id="refresh-groups" class="icon icon-refresh"></span></div>
                      </div>
                      <!--End::Menu fijo -->
                        <div id="qualifier-groups"></div>
                        <div class="container-spin">
                          <span id="refresh-spin-revisa" class="icon "></span>
                        </div>
                    </div>
                  </div>
        
                  <div class="card">
                    <div class="menu-group"></div>
                      <!-- Menu fijo -->
                      <div class="group no-select">
                        <div>
                          <div class="title">Criterios propios:</div>
                          <div id="own-criteria-title" class="subtitle"></div>
                          <span id="spin-revisa-1" class="icon "></span>
                        </div>
                        <div class="icon-refresh-revisa"><span id="refresh-groups-1" class="icon icon-refresh"></span></div>
                      </div>
                      <!--End::Menu fijo -->
          
                      <div id="qualifier_custom_groups"></div>
                      <div class="container-spin">
                        <span id="refresh-spin-revisa-2" class="icon "></span>
                      </div>

                  </div>
        
                </div>
              </div>
            </div>

        </div>
        <div class="my-2 mt-5 p-2 pb-3 text-center font-bold gestion-propia no-select">
          <a class="url-mia" href="https://hunter-pre.miaintelligence.com/landing">
            <span class="icon icon-plus text-xl"></span>
            <span>Gestión de criterios propios</span>
          </a>
        </div>
      </div>









      <!-- <div class="container-head-reviza">
              <div class="d-flex flex-column container-box-reviza">
                <h3 id="response-text-revisa"></h3>
                <span id="group-name"></span>
              </div>
              <div id="revisa-btn" class="box-refresh">
                <span class="icon icon-refresh icon-refresh-formated"></span>
              </div>
            </div>
            <div class="container-loading-revisa">
              <div id="loadingRevisa" class="loader" style="display: none"></div>
            </div>

            <section class="container-shadow">
              <div>
                <div class="box-grey no-select">
                  <span class="grey-simbol">-</span>
                </div>
                <select name="" id="criteria-select"></select>
              </div>
              <div class="box-description">
                <span id="criteria-description"></span>
              </div>
              <div class="container-badge">
                <div id="box-badge" class="badge no-select">
                  <span id="criteria-importance" class=""></span>
                </div>
                <div class="badge badge-bg-ligth-blue no-select">
                  <span
                    id="criteria-norms"
                    class="badge-text-ligth-blue"
                  ></span>
                </div>
              </div>
              <div>
                <div class="container-btn">
                  <span class="btn-revisa btn-green no-select"
                    ><span class="icon icon-refresh icon-white"></span
                    >Revisar</span
                  >
                  <span class="btn-revisa btn-grey no-select"
                    ><span class="icon icon-task-square icon-white"></span
                    >Corregir</span
                  >
                </div>
              </div>
            </section>

            <div id="res-revisar"></div> -->
            </div>

      <!-- ------------------Fin pestaña Revisa------------------ -->
      <!-- -----------------Inicio pestaña Extrae----------------- -->
      <div id="tab-3" style="display: none">
        <div class="envios-container">
          <div class="box-response-text">
            <div id="loadingMessageEnv" class="loader" style="display: none"></div>
            <div id="response-text"></div>
          </div>
        </div>
        <div class="box-delete-token">
          <span>Eliminar Token</span>
          <div class="ms-welcome__action ms-Button ms-Button--hero mb btn-revisa">
            <button id="eliminar-token">Eliminar</button>
          </div>
          <span id="openDialogButton" class="btn-clasif-auto btn-aplicar btn-green no-select mt-2">popup 1</span>
          <span id="openDialogButton2" class="btn-clasif-auto btn-aplicar btn-green no-select mt-2">popup 2</span>
          <span id="idiomaDoc" class="btn-clasif-auto btn-aplicar btn-green no-select mt-2">idioma</span>
          <span id="response-delete-token" style="color: rgb(0, 189, 25)"></span>
          <span id="error-delete-token" style="color: rgb(170, 51, 51)"></span>
        </div>
      </div>
      <!-- -----------------Fin pestaña Extrae----------------- -->
    </section>
    <!-- --------------------Fin Cuerpo de pestañas------------------- -->

    <h2 id="response-container" class="ms-font-xl"></h2>
  </main>
  <div class="popup-overlay" id="popup" style="display: none;">
    <div class="popup-content">
      <div class="popup-title">Oops!</div>
      <div class="popup-message">Se ha perdido la sesión. Por favor, inicie sesión de nuevo.</div>
      <button id="reload-plugin" class="popup-button">Volver</button>
    </div>
  </div>

  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js'></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/js/bootstrap.min.js'></script>
  <script>
    let currentlyOpenCards = []; // Variable global para rastrear las tarjetas abiertas

    function toggleCard(idCard, prefix) {
      const normativaCard = document.getElementById(`${prefix}normativas-btn-${idCard}`);
      const excludeCard = document.getElementById(`${prefix}exclude-card-${idCard}`);

    // Si no se encuentran las tarjetas, salimos
      if (!normativaCard || !excludeCard) {
        console.error(`No se encontraron las tarjetas para el ID ${idCard} con prefijo ${prefix}`);
        return;
      }

      // Alternar la visibilidad de la tarjeta
      excludeCard.classList.toggle("hidden");

      // Si la tarjeta se abrió, agregarla a la lista de abiertas
      if (!excludeCard.classList.contains("hidden")) {
        currentlyOpenCards.push(excludeCard);
      } else {
        // Si la tarjeta se cerró, eliminarla de la lista de abiertas
        currentlyOpenCards = currentlyOpenCards.filter(card => card !== excludeCard);
      }

      // Ocultar otras tarjetas que no sean la actual
      currentlyOpenCards.forEach((card) => {
        if (card !== excludeCard) {
        card.classList.add("hidden");
        }
      });

      // Agregar/quitar el evento de clic fuera
      if (currentlyOpenCards.length > 0) {
        document.addEventListener("click", handleClickOutside);
      } else {
        document.removeEventListener("click", handleClickOutside);
      }
      }

      function handleClickOutside(event) {
      // Si haces clic fuera de las tarjetas y del botón, cierra las tarjetas
      if (
        currentlyOpenCards.every(
        (card) => !card.contains(event.target) && !event.target.closest(".badge")
        )
      ) {
        currentlyOpenCards.forEach((card) => card.classList.add("hidden"));
        document.removeEventListener("click", handleClickOutside);
        currentlyOpenCards = [];
      }
    }






  </script>
</body>

</html>